# OMOD API Notes (canonical snippets)

Source: Mutagen (Loqui-generated C#) — extracted canonical signatures to avoid reflection.

## ObjectModProperty.ValueType
```csharp
public static class ObjectModProperty
{
    public enum ValueType
    {
        Int = 0,
        Float = 1,
        Bool = 2,
        String = 3,
        FormIdInt = 4,
        Enum = 5,
        FormIdFloat = 6
    }

    public enum FunctionType
    {
        Float,
        Bool,
        Enum,
        FormID
    }

    public enum FormLinkFunctionType { Set, Remove, Add }
}
```

## ObjectModFormLinkIntProperty (typed form-link-int property)
```csharp
public partial class ObjectModFormLinkIntProperty<T> : AObjectModProperty<T>, IObjectModFormLinkIntProperty<T>
    where T : struct, Enum
{
    // setter-side members
    public IFormLink<IFallout4MajorRecordGetter> Record { get; set; }
    public UInt32 Value { get; set; }
    public ObjectModProperty.FormLinkFunctionType FunctionType { get; set; }
}

public partial interface IObjectModFormLinkIntPropertyGetter<out T> : IAObjectModPropertyGetter<T>
    where T : struct, Enum
{
    IFormLinkGetter<IFallout4MajorRecordGetter> Record { get; }
    UInt32 Value { get; }
    ObjectModProperty.FormLinkFunctionType FunctionType { get; }
}
```

Notes:
- The binary-overlay getter exposes `Value` as a `UInt32` read from the record bytes (no float encoding when using this specialized type).
- `Record` is exposed as an `IFormLinkGetter<IFallout4MajorRecordGetter>` overlay — you can use its `.FormKey`/`.FormKeyNullable` helpers or remap via `ILinkCache`.

## WeaponModification / IWeaponModificationGetter.Properties
```csharp
// concrete storage (setter-side)
public ExtendedList<AObjectModProperty<Weapon.Property>> Properties { get; init; }

// getter-side (interface)
IReadOnlyList<IAObjectModPropertyGetter<Weapon.Property>> IWeaponModificationGetter.Properties => _Properties;

// therefore when you have an IAObjectModPropertyGetter<Weapon.Property> instance,
// you can attempt a cast to the formlink-int getter to avoid reflection:

// Example:
// if (prop is IObjectModFormLinkIntPropertyGetter<Weapon.Property> formLinkProp) {
//     var rawValue = formLinkProp.Value; // UInt32 raw FormID bits
//     var recordLink = formLinkProp.Record; // IFormLinkGetter<IFallout4MajorRecordGetter>
// }
```

## Practical guidance
- Avoid reading `Value1` by reflection and treating it as `float` when `ValueType == FormIdInt` — the generated typed property exposes a `UInt32 Value` and `IFormLinkGetter` for `Record` which is safe and explicit.
- To construct a `FormKey` from `Value`, combine the `rawValue` with the appropriate `ModKey` (or prefer `recordLink.FormKey` / `FormKeyNullable` when available).

## Sources
- Mutagen autogenerated files: `ObjectModFormLinkIntProperty_Generated.cs`, `ObjectModProperty.cs`, `WeaponModification_Generated.cs` (Loqui output, Mutagen repository).
